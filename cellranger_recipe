Bootstrap: docker
From: ubuntu

%labels
    Maintainer Hang(Dylan) Yang	
    Image_Name CellRanger
    Image_Version CellRanger_3.1.0
    # Reference_genome 
                  refdata-cellranger-GRCh38-3.0.0
                  refdata-cellranger-vdj-GRCh38-alts-ensembl-3.1.0

%environment
  export PATH=$PATH:/cellranger/cellranger-3.1.0

%post
  # Install extra stuff
  export DEBIAN_FRONTEND=noninteractive
  apt-get update
  apt-get install -y wget

   #--------------------------------------------------------------------------------
   # install cellranger and reference genome
   mkdir -p /cellranger &&\
         cd /cellranger &&\
         wget -O cellranger-3.1.0.tar.gz "http://cf.10xgenomics.com/releases/cell-exp/cellranger-3.1.0.tar.gz?Expires=1587014158&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cDovL2NmLjEweGdlbm9taWNzLmNvbS9yZWxlYXNlcy9jZWxsLWV4cC9jZWxscmFuZ2VyLTMuMS4wLnRhci5neiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTU4NzAxNDE1OH19fV19&Signature=Ccg7bnJ1gFfzYmrLlIgoB-u37kBuaFJqiJ-C-kVXEOREIp0SCva3ANNooQwIe~PJ9eKRg9MtGeNHg8UmBpPcnExIezEcCMmNA-MuKDbxEym8F1JM8tPn~atu9yH80JuUNsM2~Fhp~MFvVRXqViE-hh9He8dPM1wl6T6EfIB~y-rfjtGVRpCG0FSv41HU7yb7D5hFKz1b~j9l1jCiKkeE0snRTu7ddh4BkO9hKh0euTDwcrh0fHooAkJok1tySQSYufi5Gnt3bMKGQR5RAFCzKWmUfgEThF~20q5Jol789-KKePs1XW-rjDoVZXe~2G3zkjy3fnbNjFTsgnEbEcqplQ__&Key-Pair-Id=APKAI7S6A5RYOXBWRPDA" &&\
         wget http://cf.10xgenomics.com/supp/cell-exp/refdata-cellranger-GRCh38-3.0.0.tar.gz &&\
         wget http://cf.10xgenomics.com/supp/cell-vdj/refdata-cellranger-vdj-GRCh38-alts-ensembl-3.1.0.tar.gz
   tar -xvzf cellranger-3.1.0.tar.gz
   tar -xvzf refdata-cellranger-GRCh38-3.0.0.tar.gz
   tar -xvzf refdata-cellranger-vdj-GRCh38-alts-ensembl-3.1.0.tar.gz
   rm cellranger-3.1.0.tar.gz
   rm refdata-cellranger-GRCh38-3.0.0.tar.gz
   rm refdata-cellranger-vdj-GRCh38-alts-ensembl-3.1.0.tar.gz

   


  # Create directories to bind-mount data and store output
  mkdir -p /cellranger_output 
  mkdir -p /data 
  mkdir -p /work/scratch

